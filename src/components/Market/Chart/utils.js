
import { tsvParse, csvParse } from  "d3-dsv";
import { timeParse } from "d3-time-format";
//example request to stock api
import testJSON  from '../../ExampleAPI/ExampleRequest';



function parseData(parse) {
	return function(d) {
		d.date = parse(d.date);
		d.open = +d.open;
		d.high = +d.high;
		d.low = +d.low;
		d.close = +d.close;
		d.volume = +d.volume;

		return d;
	};
}

const request=[{
    "Meta Data": {
        "1. Information": "Daily Prices (open, high, low, close) and Volumes",
        "2. Symbol": "0787.HK",
        "3. Last Refreshed": "2019-11-06",
        "4. Output Size": "Compact",
        "5. Time Zone": "US/Eastern"
    },
    "Time Series (Daily)": {
        "2019-11-06": {
            "1. open": "0.5700",
            "2. high": "0.6300",
            "3. low": "0.5500",
            "4. close": "0.6300",
            "5. volume": "3337147"
        },
        "2019-11-05": {
            "1. open": "0.5500",
            "2. high": "0.5800",
            "3. low": "0.5500",
            "4. close": "0.5800",
            "5. volume": "487800"
        },
        "2019-11-04": {
            "1. open": "0.5400",
            "2. high": "0.5600",
            "3. low": "0.5400",
            "4. close": "0.5600",
            "5. volume": "573973"
        },
        "2019-11-01": {
            "1. open": "0.5300",
            "2. high": "0.5500",
            "3. low": "0.5300",
            "4. close": "0.5400",
            "5. volume": "154160"
        },
        "2019-10-31": {
            "1. open": "0.5400",
            "2. high": "0.5500",
            "3. low": "0.5300",
            "4. close": "0.5400",
            "5. volume": "242800"
        },
        "2019-10-30": {
            "1. open": "0.5300",
            "2. high": "0.5500",
            "3. low": "0.5300",
            "4. close": "0.5500",
            "5. volume": "292929"
        },
        "2019-10-29": {
            "1. open": "0.5400",
            "2. high": "0.5500",
            "3. low": "0.5300",
            "4. close": "0.5400",
            "5. volume": "336400"
        },
        "2019-10-28": {
            "1. open": "0.5500",
            "2. high": "0.5500",
            "3. low": "0.5400",
            "4. close": "0.5500",
            "5. volume": "482000"
        },
        "2019-10-25": {
            "1. open": "0.5500",
            "2. high": "0.5600",
            "3. low": "0.5400",
            "4. close": "0.5600",
            "5. volume": "252000"
        },
        "2019-10-24": {
            "1. open": "0.5500",
            "2. high": "0.5600",
            "3. low": "0.5400",
            "4. close": "0.5600",
            "5. volume": "132480"
        },
        "2019-10-23": {
            "1. open": "0.5400",
            "2. high": "0.5600",
            "3. low": "0.5400",
            "4. close": "0.5500",
            "5. volume": "250600"
        },
        "2019-10-22": {
            "1. open": "0.5600",
            "2. high": "0.5700",
            "3. low": "0.5400",
            "4. close": "0.5400",
            "5. volume": "1221000"
        },
        "2019-10-21": {
            "1. open": "0.5700",
            "2. high": "0.5900",
            "3. low": "0.5500",
            "4. close": "0.5600",
            "5. volume": "1767200"
        },
        "2019-10-18": {
            "1. open": "0.5700",
            "2. high": "0.5900",
            "3. low": "0.5600",
            "4. close": "0.5700",
            "5. volume": "696695"
        },
        "2019-10-17": {
            "1. open": "0.5700",
            "2. high": "0.5900",
            "3. low": "0.5700",
            "4. close": "0.5900",
            "5. volume": "163200"
        },
        "2019-10-16": {
            "1. open": "0.5800",
            "2. high": "0.6000",
            "3. low": "0.5700",
            "4. close": "0.5800",
            "5. volume": "413640"
        },
        "2019-10-15": {
            "1. open": "0.5700",
            "2. high": "0.5900",
            "3. low": "0.5700",
            "4. close": "0.5900",
            "5. volume": "236000"
        },
        "2019-10-14": {
            "1. open": "0.5800",
            "2. high": "0.5900",
            "3. low": "0.5800",
            "4. close": "0.5900",
            "5. volume": "298000"
        },
        "2019-10-11": {
            "1. open": "0.5600",
            "2. high": "0.6000",
            "3. low": "0.5600",
            "4. close": "0.5800",
            "5. volume": "154227"
        },
        "2019-10-10": {
            "1. open": "0.5800",
            "2. high": "0.5900",
            "3. low": "0.5500",
            "4. close": "0.5800",
            "5. volume": "733000"
        },
        "2019-10-09": {
            "1. open": "0.5900",
            "2. high": "0.6000",
            "3. low": "0.5800",
            "4. close": "0.6000",
            "5. volume": "262200"
        },
        "2019-10-08": {
            "1. open": "0.6000",
            "2. high": "0.6200",
            "3. low": "0.6000",
            "4. close": "0.6100",
            "5. volume": "102578"
        },
        "2019-10-04": {
            "1. open": "0.6300",
            "2. high": "0.6400",
            "3. low": "0.6100",
            "4. close": "0.6200",
            "5. volume": "395200"
        },
        "2019-10-03": {
            "1. open": "0.6200",
            "2. high": "0.6400",
            "3. low": "0.6100",
            "4. close": "0.6400",
            "5. volume": "321200"
        },
        "2019-10-02": {
            "1. open": "0.6200",
            "2. high": "0.6300",
            "3. low": "0.6200",
            "4. close": "0.6300",
            "5. volume": "478678"
        },
        "2019-09-30": {
            "1. open": "0.6100",
            "2. high": "0.6400",
            "3. low": "0.6100",
            "4. close": "0.6300",
            "5. volume": "371400"
        },
        "2019-09-27": {
            "1. open": "0.6200",
            "2. high": "0.6500",
            "3. low": "0.6000",
            "4. close": "0.6200",
            "5. volume": "1506987"
        },
        "2019-09-26": {
            "1. open": "0.6200",
            "2. high": "0.6500",
            "3. low": "0.6100",
            "4. close": "0.6200",
            "5. volume": "1912571"
        },
        "2019-09-25": {
            "1. open": "0.6300",
            "2. high": "0.6500",
            "3. low": "0.6100",
            "4. close": "0.6400",
            "5. volume": "2536400"
        },
        "2019-09-24": {
            "1. open": "0.6600",
            "2. high": "0.6700",
            "3. low": "0.6300",
            "4. close": "0.6400",
            "5. volume": "1281880"
        },
        "2019-09-23": {
            "1. open": "0.6200",
            "2. high": "0.7100",
            "3. low": "0.5700",
            "4. close": "0.6700",
            "5. volume": "14735720"
        },
        "2019-09-20": {
            "1. open": "0.5000",
            "2. high": "0.6400",
            "3. low": "0.4950",
            "4. close": "0.6200",
            "5. volume": "8572072"
        },
        "2019-09-19": {
            "1. open": "0.5000",
            "2. high": "0.5200",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "1669594"
        },
        "2019-09-18": {
            "1. open": "0.5100",
            "2. high": "0.5200",
            "3. low": "0.5100",
            "4. close": "0.5200",
            "5. volume": "342200"
        },
        "2019-09-17": {
            "1. open": "0.5100",
            "2. high": "0.5200",
            "3. low": "0.5100",
            "4. close": "0.5100",
            "5. volume": "350400"
        },
        "2019-09-16": {
            "1. open": "0.5000",
            "2. high": "0.5200",
            "3. low": "0.5000",
            "4. close": "0.5100",
            "5. volume": "395000"
        },
        "2019-09-13": {
            "1. open": "0.5000",
            "2. high": "0.5200",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "1097840"
        },
        "2019-09-12": {
            "1. open": "0.5100",
            "2. high": "0.5200",
            "3. low": "0.5000",
            "4. close": "0.5200",
            "5. volume": "613000"
        },
        "2019-09-11": {
            "1. open": "0.4950",
            "2. high": "0.5200",
            "3. low": "0.4900",
            "4. close": "0.5100",
            "5. volume": "1377390"
        },
        "2019-09-10": {
            "1. open": "0.5000",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5000",
            "5. volume": "102151"
        },
        "2019-09-09": {
            "1. open": "0.5100",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5000",
            "5. volume": "443600"
        },
        "2019-09-06": {
            "1. open": "0.4950",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "377008"
        },
        "2019-09-05": {
            "1. open": "0.4900",
            "2. high": "0.5100",
            "3. low": "0.4900",
            "4. close": "0.4950",
            "5. volume": "480400"
        },
        "2019-09-04": {
            "1. open": "0.4850",
            "2. high": "0.4950",
            "3. low": "0.4850",
            "4. close": "0.4950",
            "5. volume": "438473"
        },
        "2019-09-03": {
            "1. open": "0.4900",
            "2. high": "0.5000",
            "3. low": "0.4900",
            "4. close": "0.4950",
            "5. volume": "377400"
        },
        "2019-09-02": {
            "1. open": "0.4900",
            "2. high": "0.5000",
            "3. low": "0.4850",
            "4. close": "0.4900",
            "5. volume": "756997"
        },
        "2019-08-30": {
            "1. open": "0.5000",
            "2. high": "0.5000",
            "3. low": "0.4850",
            "4. close": "0.4950",
            "5. volume": "1451800"
        },
        "2019-08-29": {
            "1. open": "0.5000",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5000",
            "5. volume": "392713"
        },
        "2019-08-28": {
            "1. open": "0.4950",
            "2. high": "0.5200",
            "3. low": "0.4900",
            "4. close": "0.5100",
            "5. volume": "1433000"
        },
        "2019-08-27": {
            "1. open": "0.5100",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "369400"
        },
        "2019-08-26": {
            "1. open": "0.5500",
            "2. high": "0.5500",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "2612800"
        },
        "2019-08-23": {
            "1. open": "0.5700",
            "2. high": "0.5700",
            "3. low": "0.5200",
            "4. close": "0.5500",
            "5. volume": "468000"
        },
        "2019-08-22": {
            "1. open": "0.5100",
            "2. high": "0.5600",
            "3. low": "0.5100",
            "4. close": "0.5600",
            "5. volume": "2511115"
        },
        "2019-08-21": {
            "1. open": "0.4900",
            "2. high": "0.5100",
            "3. low": "0.4900",
            "4. close": "0.5100",
            "5. volume": "391400"
        },
        "2019-08-20": {
            "1. open": "0.4850",
            "2. high": "0.5000",
            "3. low": "0.4850",
            "4. close": "0.4900",
            "5. volume": "131001"
        },
        "2019-08-19": {
            "1. open": "0.4850",
            "2. high": "0.4950",
            "3. low": "0.4850",
            "4. close": "0.4950",
            "5. volume": "364475"
        },
        "2019-08-16": {
            "1. open": "0.4850",
            "2. high": "0.4950",
            "3. low": "0.4800",
            "4. close": "0.4800",
            "5. volume": "809600"
        },
        "2019-08-15": {
            "1. open": "0.4850",
            "2. high": "0.4900",
            "3. low": "0.4750",
            "4. close": "0.4850",
            "5. volume": "1167300"
        },
        "2019-08-14": {
            "1. open": "0.5000",
            "2. high": "0.5100",
            "3. low": "0.4850",
            "4. close": "0.4850",
            "5. volume": "1265400"
        },
        "2019-08-13": {
            "1. open": "0.4950",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "1014000"
        },
        "2019-08-12": {
            "1. open": "0.4950",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "533600"
        },
        "2019-08-09": {
            "1. open": "0.5000",
            "2. high": "0.5100",
            "3. low": "0.4950",
            "4. close": "0.5100",
            "5. volume": "857038"
        },
        "2019-08-08": {
            "1. open": "0.5100",
            "2. high": "0.5200",
            "3. low": "0.4850",
            "4. close": "0.4850",
            "5. volume": "2376040"
        },
        "2019-08-07": {
            "1. open": "0.5200",
            "2. high": "0.5200",
            "3. low": "0.5000",
            "4. close": "0.5100",
            "5. volume": "1465478"
        },
        "2019-08-06": {
            "1. open": "0.5200",
            "2. high": "0.5400",
            "3. low": "0.5000",
            "4. close": "0.5200",
            "5. volume": "2882400"
        },
        "2019-08-05": {
            "1. open": "0.5800",
            "2. high": "0.5800",
            "3. low": "0.5400",
            "4. close": "0.5500",
            "5. volume": "2405096"
        },
        "2019-08-02": {
            "1. open": "0.6000",
            "2. high": "0.6100",
            "3. low": "0.5800",
            "4. close": "0.5900",
            "5. volume": "1494196"
        },
        "2019-08-01": {
            "1. open": "0.6100",
            "2. high": "0.6200",
            "3. low": "0.6000",
            "4. close": "0.6200",
            "5. volume": "853200"
        },
        "2019-07-31": {
            "1. open": "0.6100",
            "2. high": "0.6200",
            "3. low": "0.6100",
            "4. close": "0.6200",
            "5. volume": "634947"
        },
        "2019-07-30": {
            "1. open": "0.6200",
            "2. high": "0.6300",
            "3. low": "0.6100",
            "4. close": "0.6100",
            "5. volume": "514100"
        },
        "2019-07-29": {
            "1. open": "0.6300",
            "2. high": "0.6300",
            "3. low": "0.6100",
            "4. close": "0.6200",
            "5. volume": "1347782"
        },
        "2019-07-26": {
            "1. open": "0.6400",
            "2. high": "0.6400",
            "3. low": "0.6300",
            "4. close": "0.6400",
            "5. volume": "512000"
        },
        "2019-07-25": {
            "1. open": "0.6300",
            "2. high": "0.6400",
            "3. low": "0.6200",
            "4. close": "0.6400",
            "5. volume": "931568"
        },
        "2019-07-24": {
            "1. open": "0.6300",
            "2. high": "0.6400",
            "3. low": "0.6200",
            "4. close": "0.6400",
            "5. volume": "1001975"
        },
        "2019-07-23": {
            "1. open": "0.6400",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6300",
            "5. volume": "842228"
        },
        "2019-07-22": {
            "1. open": "0.6600",
            "2. high": "0.6600",
            "3. low": "0.6400",
            "4. close": "0.6500",
            "5. volume": "504000"
        },
        "2019-07-19": {
            "1. open": "0.6400",
            "2. high": "0.6600",
            "3. low": "0.6300",
            "4. close": "0.6600",
            "5. volume": "489800"
        },
        "2019-07-18": {
            "1. open": "0.6400",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6500",
            "5. volume": "550200"
        },
        "2019-07-17": {
            "1. open": "0.6500",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6500",
            "5. volume": "402200"
        },
        "2019-07-16": {
            "1. open": "0.6500",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6300",
            "5. volume": "684800"
        },
        "2019-07-15": {
            "1. open": "0.6400",
            "2. high": "0.6500",
            "3. low": "0.6400",
            "4. close": "0.6500",
            "5. volume": "187600"
        },
        "2019-07-12": {
            "1. open": "0.6300",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6500",
            "5. volume": "1156200"
        },
        "2019-07-11": {
            "1. open": "0.6600",
            "2. high": "0.6700",
            "3. low": "0.6400",
            "4. close": "0.6400",
            "5. volume": "390200"
        },
        "2019-07-10": {
            "1. open": "0.6500",
            "2. high": "0.6600",
            "3. low": "0.6500",
            "4. close": "0.6500",
            "5. volume": "304512"
        },
        "2019-07-09": {
            "1. open": "0.6600",
            "2. high": "0.6800",
            "3. low": "0.6500",
            "4. close": "0.6600",
            "5. volume": "548000"
        },
        "2019-07-08": {
            "1. open": "0.6700",
            "2. high": "0.6800",
            "3. low": "0.6500",
            "4. close": "0.6700",
            "5. volume": "1205000"
        },
        "2019-07-05": {
            "1. open": "0.7200",
            "2. high": "0.7200",
            "3. low": "0.6900",
            "4. close": "0.6900",
            "5. volume": "911600"
        },
        "2019-07-04": {
            "1. open": "0.7100",
            "2. high": "0.7200",
            "3. low": "0.7000",
            "4. close": "0.7200",
            "5. volume": "1128800"
        },
        "2019-07-03": {
            "1. open": "0.7100",
            "2. high": "0.7100",
            "3. low": "0.7000",
            "4. close": "0.7000",
            "5. volume": "1269440"
        },
        "2019-07-02": {
            "1. open": "0.7100",
            "2. high": "0.7300",
            "3. low": "0.7000",
            "4. close": "0.7200",
            "5. volume": "1611600"
        },
        "2019-06-28": {
            "1. open": "0.6900",
            "2. high": "0.7600",
            "3. low": "0.6900",
            "4. close": "0.7000",
            "5. volume": "6322930"
        },
        "2019-06-27": {
            "1. open": "0.6900",
            "2. high": "0.7100",
            "3. low": "0.6900",
            "4. close": "0.7000",
            "5. volume": "1186417"
        },
        "2019-06-26": {
            "1. open": "0.6600",
            "2. high": "0.6800",
            "3. low": "0.6600",
            "4. close": "0.6800",
            "5. volume": "794600"
        },
        "2019-06-25": {
            "1. open": "0.6600",
            "2. high": "0.6900",
            "3. low": "0.6600",
            "4. close": "0.6800",
            "5. volume": "437477"
        },
        "2019-06-24": {
            "1. open": "0.6700",
            "2. high": "0.6900",
            "3. low": "0.6600",
            "4. close": "0.6800",
            "5. volume": "428081"
        },
        "2019-06-21": {
            "1. open": "0.6600",
            "2. high": "0.6900",
            "3. low": "0.6400",
            "4. close": "0.6900",
            "5. volume": "2112248"
        },
        "2019-06-20": {
            "1. open": "0.6300",
            "2. high": "0.6700",
            "3. low": "0.6300",
            "4. close": "0.6600",
            "5. volume": "1780400"
        },
        "2019-06-19": {
            "1. open": "0.6400",
            "2. high": "0.6500",
            "3. low": "0.6300",
            "4. close": "0.6300",
            "5. volume": "1208599"
        },
        "2019-06-18": {
            "1. open": "0.6300",
            "2. high": "0.6400",
            "3. low": "0.6200",
            "4. close": "0.6400",
            "5. volume": "1115350"
        },
        "2019-06-17": {
            "1. open": "0.6300",
            "2. high": "0.6400",
            "3. low": "0.6200",
            "4. close": "0.6400",
            "5. volume": "448600"
        }
    }
}];



const parseDate = timeParse("%Y-%m-%d");

const parseJSON=(data)=>{
	const dates = Object.keys(data[0]['Time Series (Daily)']);
	
	const json = [];
	json.date=[];
	json.open=[];
	json.high =[];
	json.low =[];
	json.close=[];
	json.volume=[];
	
	for(const date of dates)
	{
		const row = {};
		
		row.date = parseDate(date);

		row.open = data[0]['Time Series (Daily)'][date]['1. open'];
		row.high  = data[0]['Time Series (Daily)'][date]['2. high'];
		row.low= data[0]['Time Series (Daily)'][date]['3. low'];
		row.close = data[0]['Time Series (Daily)'][date]['4. close'];
		row.volume = data[0]['Time Series (Daily)'][date]['5. volume'];
		json.push(row);
		
	


	}
	json.reverse();

	
	return  json;
}

export function getData() {
	return parseJSON(testJSON);
}
/*
export function getData() {
	const promiseMSFT = fetch("https://cdn.rawgit.com/rrag/react-stockcharts/master/docs/data/MSFT.tsv")
		.then(response => response.text())
		.then(data => tsvParse(data, parseData(parseDate)))
	
	return promiseMSFT;
}
*/